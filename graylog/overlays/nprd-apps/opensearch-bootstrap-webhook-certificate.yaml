# OpenSearch Bootstrap Webhook TLS Certificate
#
# Creates a TLS certificate for the webhook server using cert-manager.
#
# Prerequisites:
#   - cert-manager installed in cluster
#   - ClusterIssuer or Issuer available (update issuerRef if different)
#
# The certificate will be stored in secret: opensearch-bootstrap-webhook-cert
# The CA bundle will need to be extracted and added to MutatingWebhookConfiguration.
#
# See OPENSEARCH_BOOTSTRAP_WORKAROUND.md for manual certificate setup if cert-manager
# is not available.

apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: opensearch-bootstrap-webhook-cert
  namespace: managed-graylog
  labels:
    app: opensearch-bootstrap-webhook
    managed-by: gitops
    cluster: nprd-apps
spec:
  secretName: opensearch-bootstrap-webhook-cert
  issuerRef:
    # Update this to match your cluster's issuer
    # Common options:
    #   - selfsigned-issuer (ClusterIssuer)
    #   - letsencrypt-prod (ClusterIssuer for Let's Encrypt)
    #   - ca-issuer (ClusterIssuer for internal CA)
    name: selfsigned-issuer
    kind: ClusterIssuer
  dnsNames:
    - opensearch-bootstrap-webhook.managed-graylog.svc
    - opensearch-bootstrap-webhook.managed-graylog.svc.cluster.local
