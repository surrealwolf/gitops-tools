# Wazuh Server Filebeat ConfigMap
# Filebeat configuration for sending alerts to Wazuh Indexer
apiVersion: v1
kind: ConfigMap
metadata:
  name: wazuh-server-filebeat-config
  namespace: managed-tools
  labels:
    app: wazuh
    component: server
    managed-by: gitops
data:
  filebeat.yml: |
    # Wazuh - Filebeat configuration file
    filebeat.modules:
      - module: wazuh
        alerts:
          enabled: true
        archives:
          enabled: false

    setup.template.json.enabled: true
    setup.template.overwrite: true
    setup.template.json.path: '/etc/filebeat/wazuh-template.json'
    setup.template.json.name: 'wazuh'
    setup.ilm.enabled: false
    output.elasticsearch:
      hosts: ['https://wazuh-indexer:9200']
      username: 'admin'
      password: 'admin'
      ssl.verification_mode: none
      ssl.certificate_authorities: ['/etc/filebeat/certs/root-ca.pem']

    logging.metrics.enabled: false

    seccomp:
      default_action: allow
      syscalls:
      - action: allow
        names:
        - rseq
