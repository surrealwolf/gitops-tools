# Vector Syslog Service for UniFi CEF Input
#
# This service exposes Vector's syslog receiver for external access.
# UniFi devices will send CEF-formatted syslog to vector.dataknife.net:514
# Vector will parse the CEF format and forward to Loki.
#
apiVersion: v1
kind: Service
metadata:
  name: vector-syslog
  namespace: managed-syslog
  labels:
    app: vector
    component: syslog
    managed-by: gitops
    cluster: nprd-apps
spec:
  type: NodePort
  ports:
  - name: syslog-udp
    port: 514
    targetPort: 514
    protocol: UDP
    nodePort: 30514
    # UDP syslog port - UniFi devices send CEF syslog to vector.dataknife.net:30514
    # NodePort 30514 maps to internal port 514 UDP
  - name: metrics
    port: 9598
    targetPort: 9598
    protocol: TCP
    # Metrics and health endpoint - exposed via ingress at vector.dataknife.net
  selector:
    # Match Vector pod labels
    app: vector
    component: syslog
  # Note: 
  # - UDP port 514 (syslog) is exposed via NodePort 30514
  # - DNS: Point vector.dataknife.net A record to cluster node IPs (worker nodes recommended)
  # - UniFi devices send to vector.dataknife.net:30514 (UDP)
  # - TCP port 9598 (metrics) is exposed via ingress at vector.dataknife.net
  # - Vector automatically receives syslog on UDP 514 and parses CEF format
